{"version":3,"sources":["web/scripts/stylez.viewer.js"],"names":["SessionStorage","require","Prism","evalHTML","partialHTML","parser","DOMParser","fixedContent","parseFromString","partialDoc","DocumentFragment","append","body","firstChild","innerHTML","error","message","cpyToClipboard","event","curElement","target","parentElement","curContent","querySelector","navigator","clipboard","writeText","console","fetchPattern","url","fetch","then","response","status","json","catch","pattern","data","patterns","sort","a","b","file","curSession","getCurrentFilter","currentPatterns","filter","item","category","currentFilter","index","length","curIndex","maxIndex","title","updateStatus","patternsContainer","document","copyCpl","forEach","curTemplate","stylez","templates","name","replace","templateContent","undefined","evaledContent","content","split","pop","insertAdjacentHTML","copyElements","querySelectorAll","addEventListener","highlightAll"],"mappings":"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","sourcesContent":["const SessionStorage = require('./stylez.storage');\nconst Prism = require('prismjs');\n\nconst evalHTML = (partialHTML) => {\n\n    try {\n        let parser = new DOMParser();\n        let fixedContent = parser.parseFromString(partialHTML, 'text/html');\n\n        let partialDoc = new DocumentFragment();\n        partialDoc.append(fixedContent.body);\n\n        return partialDoc.firstChild.innerHTML;\n\n    } catch (error) {\n        return error.message;\n    }\n\n}\n\nconst cpyToClipboard = (event) => {\n\n    let curElement = event.target.parentElement.parentElement,\n        curContent = curElement.querySelector('.viewer-content');\n\n    try {\n        navigator.clipboard.writeText(curContent.innerHTML);\n    } catch (error) {\n        console.error(error);\n    }\n\n}\n\nconst fetchPattern = async () => {\n\n    let url = './app/config/stylez.json';\n\n    return fetch(url)\n        .then((response) => {\n\n            if (response.status === 200) {\n\n                return response.json();\n\n            } else {\n\n                throw \"Error current status: \" + response.status + \" - \" + url;\n\n            }\n\n        })\n        .catch(error => {\n\n            console.error('ERROR :::', error);\n\n        })\n\n}\n\nlet pattern = fetchPattern();\n// let pattern = StylezData.Pattern();\n\npattern.then(data => {\n\n    let patterns = data.patterns.sort((a, b) => {\n        if (a.file < b.file) {\n            return -1;\n        }\n        if (a.file > b.file) {\n            return 1;\n        }\n        return 0;\n    })\n\n    var curSession = SessionStorage.getCurrentFilter();\n\n    let currentPatterns = patterns.filter(item => {\n        return item.category === curSession.category;\n    });\n\n    let currentFilter = SessionStorage.getCurrentFilter();\n\n    if (curSession.category === 'pages' ||\n        curSession.category === 'templates' || currentFilter.index !== null) {\n\n        if (currentPatterns.length !== 0) {\n\n            let curIndex = currentFilter.index ? currentFilter.index : 0;\n\n            currentFilter.maxIndex = currentPatterns.length - 1;\n            currentFilter.index = curIndex;\n\n            currentFilter.title = currentPatterns[curIndex].title;\n\n            currentPatterns = [currentPatterns[curIndex]];\n\n            // let currentPatternTitle = document.querySelector('.a-filtername');\n            // currentPatternTitle.textContent = currentFilter.title;\n\n            SessionStorage.updateStatus(currentFilter);\n\n        } else {\n\n            currentFilter.maxIndex = null;\n            currentFilter.index = null;\n            currentFilter.title = null;\n\n            SessionStorage.updateStatus(currentFilter);\n\n        }\n\n    } else {\n\n        currentFilter.maxIndex = null;\n        currentFilter.index = null;\n        currentFilter.title = null;\n\n        SessionStorage.updateStatus(currentFilter);\n\n    }\n\n    if (currentPatterns.length !== 0) {\n\n        const patternsContainer = document.querySelector('.patterns');\n\n        const copyCpl = navigator && navigator.clipboard ? \"<div title='Copy to clip board' aria-label='Copy to clip board' class='viewer-filename copy'>copy</div>\" : \"\";\n\n        currentPatterns.forEach(pattern => {\n\n            let curTemplate = stylez.templates[pattern.name.replace(/.hbs/ig, '')];\n\n            let templateContent;\n\n            try {\n                templateContent = curTemplate();\n            } catch (error) {\n                console.error(`Error in Pattern ${pattern.title}: ${error.message}`);\n                templateContent = `Error in Pattern ${pattern.title}: ${error.message}`;\n            }\n\n            if (curTemplate !== undefined && templateContent !== 'undefined') {\n\n                let evaledContent = evalHTML(templateContent);\n\n                const content = `<div data-category='${pattern.category}' class='viewer-pattern' aria-label='Pattern ${ pattern.title }'>\n            <div class='viewer-header' aria-label='Header for ${ pattern.title }' >\n                <div title='${ pattern.title }' class='viewer-title'>${ pattern.title }</div>\n                ${ copyCpl }\n                <div title='${pattern.file }' class='viewer-filename' aria-lable='file location'>${pattern.file.split('/').pop()}</div>\n            </div>\n            <div class='viewer-content' aria-label='Content of ${ pattern.title } pattern'>\n            <div class='viewer-contentinner'>\n            ${ evaledContent }\n            </div>\n            </div>\n            <pre class='viewer-code language-markup' data-manual><code>${ evaledContent.replace(/</g, '&lt;').replace(/>/g, '&gt;') }</code></pre>\n            </div>`;\n\n                patternsContainer.insertAdjacentHTML('beforeend', content);\n\n            }\n\n        })\n\n        var copyElements = document.querySelectorAll('.copy');\n\n        copyElements.forEach(item => {\n\n            item.addEventListener('click', cpyToClipboard);\n\n        });\n\n    }\n\n    // show markup code\n    Prism.highlightAll();\n})"],"file":"stylez.viewer.js"}